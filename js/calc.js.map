{"version":3,"sources":["../../../app/js/calc.js"],"names":[],"mappings":"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","file":"calc.js","sourcesContent":["/*\n * Copyright (c) 2012, Intel Corporation.\n *\n * This program is licensed under the terms and conditions of the\n * Apache License, version 2.0.  The full text of the Apache License is at\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n */\n\nlet Calculator = {};\n\n(function() {\n  'use strict';\n\n  let Raf = new function() {\n    //\n    // Functions\n    //\n    let _domChanges = [];\n\n    let _setClass = function(selectorOrElement, classToSet) {\n      let elements = [];\n      if (typeof selectorOrElement === 'string') {\n        elements = document.querySelectorAll(selectorOrElement);\n      } else {\n        elements.push(selectorOrElement);\n      }\n\n      for (let i = 0; i < elements.length; i++) {\n        let element = elements[i];\n\n        element.className = '';\n        element.classList.add(classToSet);\n      }\n    };\n\n    let _setStyle = function(selector, property, value) {\n      let elements = document.querySelectorAll(selector);\n\n      for (let i = 0; i < elements.length; i++) {\n        let element = elements[i];\n\n        element.style[property] = value;\n      }\n    };\n\n    let _appendChild = function(parentElement, child) {\n      parentElement.appendChild(child);\n    };\n\n    let _doDomChanges = function() {\n      let numDomChanges = _domChanges.length;\n      for (let i = 0; i < numDomChanges; i++) {\n        let thisChange = _domChanges.pop();\n\n        switch (thisChange.type) {\n          case 'class':\n            _setClass(\n              thisChange.selectorOrElement,\n              thisChange.classToSet\n            );\n            break;\n          case 'style':\n            _setStyle(\n              thisChange.selector,\n              thisChange.property,\n              thisChange.value\n            );\n            break;\n          case 'child':\n            _appendChild(\n              thisChange.parentElement,\n              thisChange.child\n            );\n            break;\n          default:\n            console.error('Unknown dom change type');\n            break;\n        }\n      }\n    };\n\n    this.queueClassChange = function(selectorOrElement, classToSet) {\n      let newChange = {\n        type: 'class',\n        selectorOrElement: selectorOrElement,\n        classToSet: classToSet\n      };\n\n      _domChanges.push(newChange);\n\n      if (_domChanges.length === 1) {\n        window.requestAnimationFrame(_doDomChanges);\n      }\n    };\n\n    this.queueStyleChange = function(selector, property, value) {\n      let newChange = {\n        type: 'style',\n        selector: selector,\n        property: property,\n        value: value\n      };\n\n      _domChanges.push(newChange);\n\n      if (_domChanges.length === 1) {\n        window.requestAnimationFrame(_doDomChanges);\n      }\n    };\n\n    this.queueAppendChild = function(parentElement, child) {\n      let newChange = {\n        type: 'child',\n        parentElement: parentElement,\n        child: child\n      };\n\n      _domChanges.push(newChange);\n\n      if (_domChanges.length === 1) {\n        window.requestAnimationFrame(_doDomChanges);\n      }\n    };\n\n    let _doMaximiseBody = function() {\n      // apply scaling transform\n      let docWidth = document.documentElement.clientWidth;\n      let docHeight = document.documentElement.clientHeight;\n      let body = document.querySelector('body');\n      let bodyWidth = body.clientWidth;\n      let bodyHeight = body.clientHeight;\n\n      document.body.style['-webkit-transform'] =\n        `translate(-50%, -50%) \\\n         scale(${docWidth / bodyWidth}, ${docHeight / bodyHeight})`;\n      document.body.style.transform =\n        `translate(-50%, -50%) \\\n         scale(${docWidth / bodyWidth}, ${docHeight / bodyHeight})`;\n    };\n\n    this.maximiseBody = function() {\n      window.requestAnimationFrame(_doMaximiseBody);\n    };\n  };\n\n  Calculator = new function() {\n    this.localizer = null;\n    this.parser = '';\n    this.currentKey = '';\n    this.cssAppendix = '_portrait.css';\n\n    /**\n     * formula that has been computed already and its shown in the current formula area\n     */\n    this.currentFormula = '';\n\n    // The below two stacks are maintained to do consistent backspace operation\n    /**\n     * Stack of elements that has been pressed after '=' press && which are shown\n     * in mainEntry area.\n     *\n     * This stack is used to undo user's button presses until the previous\n     * valid calculation ('=' press)\n     */\n    this.mainEntryStack = [];\n\n    /**\n     * Stack of elements that has been pressed after '=' press && which are shown\n     * in current formula area (except already computed formula).\n     *\n     * This stack is used to undo user's button presses until the previous\n     * valid calculation ('=' press)\n     */\n    this.currentFormulaStack = [];\n    this.currentPage = 'calculationpane';\n\n    /**\n     * number of decimal digits to be preserved on trigonometric calculations\n     */\n    this.trigPrecision = 10000000000;\n\n    // Functions for transitioning between states.\n    //\n    this.transitionToDegrees = function() {\n      let classes = {\n        '#degradswitch': 'switchleftactive',\n        '#buttondeg': 'buttontogglebackgroundB',\n        '#buttonrad': 'buttontogglebackgroundA'\n      };\n\n      Object.keys(classes).forEach(id => Raf.queueClassChange(id, classes[id]));\n\n      Calculator.angleDivisor = 180 / Math.PI;\n    };\n\n    this.transitionToRadians = function() {\n      let classes = {\n        '#degradswitch': 'switchrightactive',\n        '#buttondeg': 'buttontogglebackgroundA',\n        '#buttonrad': 'buttontogglebackgroundB'\n      };\n\n      Object.keys(classes).forEach(id => Raf.queueClassChange(id, classes[id]));\n\n      Calculator.angleDivisor = 1;\n    };\n\n    this.transitionToTrigonometricFunctions = function() {\n      let classes = {\n        '#traghypswitch': 'switchleftactive',\n        '#buttontrig': 'buttontogglebackgroundB',\n        '#buttonhyp': 'buttontogglebackgroundA'\n      };\n\n      Object.keys(classes).forEach(id => Raf.queueClassChange(id, classes[id]));\n\n      Raf.queueStyleChange('#trigonometric', 'display', 'inherit');\n      Raf.queueStyleChange('#hyperbolic', 'display', 'none');\n    };\n\n    this.transitionToHyperbolicFunctions = function() {\n      let classes = {\n        '#traghypswitch': 'switchrightactive',\n        '#buttontrig': 'buttontogglebackgroundA',\n        '#buttonhyp': 'buttontogglebackgroundB'\n      };\n\n      Object.keys(classes).forEach(id => Raf.queueClassChange(id, classes[id]));\n\n      Raf.queueStyleChange('#trigonometric', 'display', 'none');\n      Raf.queueStyleChange('#hyperbolic', 'display', 'inherit');\n    };\n\n    // Helper function for clearing main entry and current formula as needed.\n    //\n    this.handleClearOnNumberButtonClick = function() {\n      if (Calculator.clearMainEntryOnNextNumberButton) {\n        Calculator.setMainEntry('');\n        Calculator.mainEntryStack.splice(0, Calculator.mainEntryStack.length);\n      }\n\n      if (Calculator.clearCurrentFormulaOnNextNumberButton) {\n        Calculator.setCurrentFormula('');\n        Calculator.currentFormulaStack.splice(\n          0,\n          Calculator.currentFormulaStack.length\n        );\n      }\n    };\n\n    this.handleClearOnFunctionButtonClick = function() {\n      if (Calculator.clearMainEntryOnNextFunctionButton) {\n        Calculator.setMainEntry('');\n        Calculator.mainEntryStack.splice(0, Calculator.mainEntryStack.length);\n      }\n\n      if (Calculator.clearCurrentFormulaOnNextFunctionButton) {\n        Calculator.setCurrentFormula('');\n        Calculator.mainEntryStack.splice(\n          0,\n          Calculator.currentFormulaStack.length\n        );\n      }\n    };\n\n    // Functions for handling button presses.\n    //\n    this.onFunctionButtonClick = function() {\n      Calculator.buttonClickAudio.play();\n      Calculator.handleClearOnFunctionButtonClick();\n\n      let operator = this.getAttribute('data-operator');\n\n      if (!operator) {\n        operator = this.innerHTML;\n      }\n\n      // move mainEntryStack content to currentFormulaStack\n      for (let i = 0; i < Calculator.mainEntryStack.length; i++) {\n        Calculator.currentFormulaStack.push(Calculator.mainEntryStack[i]);\n      }\n\n      // clear mainEntryStack\n      Calculator.mainEntryStack.splice(0, Calculator.mainEntryStack.length);\n\n      // append main entry and the operator to current formula\n      document.getElementById('currentformula').innerHTML +=\n        Calculator.getMainEntry() +\n        operator;\n      Calculator.setMainEntry('');\n\n      // push the recent operator to currentFormulaStack\n      Calculator.currentFormulaStack.push(operator);\n\n      Calculator.clearMainEntryOnNextNumberButton = false;\n      Calculator.clearMainEntryOnNextFunctionButton = false;\n      Calculator.clearCurrentFormulaOnNextNumberButton = false;\n    };\n\n    this.onNumericalButtonClick = function() {\n      Calculator.buttonClickAudio.play();\n      Calculator.handleClearOnNumberButtonClick();\n\n      let value = this.innerHTML;\n      let mainEntry = Calculator.getMainEntry();\n\n      if (mainEntry.length >= 22) {\n        return;\n      }\n\n      if (value === '0') {\n        if (mainEntry === '0') {\n          return;\n        }\n      } else if (value === '00') {\n        if (mainEntry === '0' || mainEntry === '') {\n          return;\n        }\n      } else if (value === '.') {\n        if (mainEntry === '') {\n          Calculator.appendToMainEntry('0');\n          Calculator.mainEntryStack.push('0');\n        } else if (mainEntry.indexOf(value) !== -1) {\n          return;\n        }\n      } else if (value === '+/–') {\n        // 'Plus/minus' sign.\n\n        if (mainEntry === '' || mainEntry === '0') {\n          return;\n        }\n        Calculator.setMainEntry('');\n\n        if (mainEntry.charAt(0) === '-') {\n          Calculator.appendToMainEntry(mainEntry.substring(1));\n        } else {\n          Calculator.appendToMainEntry(`-${mainEntry}`);\n        }\n        value = '';\n      }\n      // push into mainEntryStack\n      Calculator.mainEntryStack.push(value);\n\n      Calculator.appendToMainEntry(value);\n      Calculator.setClearButtonMode('C');\n      Calculator.clearMainEntryOnNextNumberButton = false;\n      Calculator.clearMainEntryOnNextFunctionButton = false;\n      Calculator.clearCurrentFormulaOnNextNumberButton = false;\n    };\n\n    this.onClearButtonClick = function() {\n      Calculator.buttonClickAudio.play();\n      let clearButtonText = document.getElementById('buttonclear').innerHTML;\n\n      if (clearButtonText === 'C') {\n        Calculator.setMainEntry('');\n      } else if (clearButtonText === 'AC') {\n        Calculator.setCurrentFormula('');\n        Calculator.currentFormula = '';\n      }\n      // clear stacks\n      let len = Calculator.mainEntryStack.length;\n      Calculator.mainEntryStack.splice(0, len);\n      len = Calculator.currentFormulaStack.length;\n      Calculator.currentFormulaStack.splice(0, len);\n\n      // update the currentformula area\n      document.getElementById('currentformula').innerHTML =\n        Calculator.currentFormula;\n    };\n\n    this.onDeleteButtonClick = function() {\n      Calculator.buttonClickAudio.play();\n      let mainEntry = Calculator.getMainEntry();\n\n      if (\n        Calculator.currentFormulaStack.length <= 0 &&\n        Calculator.mainEntryStack.length <= 0) {\n        return;\n      }\n\n      let malformedExpressionText =\n        Calculator.localizer.getTranslation('malformedExpressionText');\n      if (malformedExpressionText === mainEntry) {\n        Calculator.setMainEntry('');\n        return;\n      }\n\n      let len = 0;\n      // first delete mainEntry then currentFormula\n      if (Calculator.mainEntryStack.length > 0) {\n        // splice one element\n        len = Calculator.mainEntryStack.length;\n        Calculator.mainEntryStack.splice(len - 1, 1);\n\n        // update the remaining elements\n        mainEntry = '';\n        for (let i = 0; i < Calculator.mainEntryStack.length; i++) {\n          mainEntry += Calculator.mainEntryStack[i];\n        }\n        Calculator.setMainEntry(mainEntry);\n      } else {\n        // splice one element\n        len = Calculator.currentFormulaStack.length;\n        Calculator.currentFormulaStack.splice(len - 1, 1);\n\n        // update the remaining elements\n        let text = '';\n        for (let j = 0; j < Calculator.currentFormulaStack.length; j++) {\n          text += Calculator.currentFormulaStack[j];\n        }\n        document.getElementById('currentformula').innerHTML =\n          Calculator.currentFormula + text;\n      }\n    };\n\n    this.onEqualButtonClick = function() {\n      Calculator.equalClickAudio.play();\n      Calculator.handleClearOnFunctionButtonClick();\n\n      let mainEntry = Calculator.getMainEntry();\n      let prevFormula = Calculator.currentFormula;\n      Calculator.currentFormulaStack.push(mainEntry);\n      Calculator.appendToCurrentFormula(mainEntry);\n\n      let formula = Calculator.getCurrentFormula();\n\n      // replace ^ with x for unambiguous parsing.\n      formula = formula.replace('e<sup>^</sup>', 'e<sup>x</sup>');\n\n      let entry = '';\n      if (formula !== '') {\n        try {\n          entry = Calculator.parser.parse(formula);\n          if (isNaN(entry)) {\n            entry =\n              Calculator.localizer.getTranslation('malformedExpressionText');\n          } else if (mainEntry !== '') {\n            Calculator.appendEntryToCalculationHistory(\n              Calculator.formHistoryEntry(formula, entry)\n            );\n            Calculator.createHistoryEntryInLocalStorage(formula, entry);\n          }\n        } catch (err) {\n          entry =\n            Calculator.localizer.getTranslation('malformedExpressionText');\n        }\n\n        Calculator.setMainEntry(entry);\n      }\n\n      Calculator.clearMainEntryOnNextNumberButton = true;\n      Calculator.clearMainEntryOnNextFunctionButton = true;\n      Calculator.clearCurrentFormulaOnNextNumberButton = true;\n\n      let len = 0;\n      // clear undo stacks\n      let malformedExpressionText =\n        Calculator.localizer.getTranslation('malformedExpressionText');\n      if (entry === malformedExpressionText) {\n        // restore previous formula on error cases\n        Calculator.currentFormula = prevFormula;\n        Calculator.clearCurrentFormulaOnNextNumberButton = false;\n      } else {\n        // clear current formula stack only on valid computation\n        len = Calculator.currentFormulaStack.length;\n        Calculator.currentFormulaStack.splice(0, len);\n\n        // To maintain operator precedence, enclose the formula that has been already computed\n        Calculator.setCurrentFormula(entry);\n      }\n      len = Calculator.mainEntryStack.length;\n      Calculator.mainEntryStack.splice(0, len);\n    };\n\n    this.setClearButtonMode = function(mode) {\n      document.getElementById('buttonclear').innerHTML = mode;\n    };\n\n    // Function for adding a result history entry.\n    //\n    this.formHistoryEntry = function(formula, entry) {\n      let historyEntry = `\\\n<div class=\"thickdivisor\"></div>\\\n<div class=\"calculationpane\">\\\n  <div class=\"calculation\">\\\n    <div class=\"calculationtext\">${formula}</div>\\\n  </div>\\\n</div>\\\n<div class=\"thindivisor\"></div>\\\n<div class=\"resultpane\">\\\n  <div class=\"result\">\\\n    <div class=\"resulttext\">${entry}</div>\\\n  </div>\\\n</div>`;\n\n      return historyEntry;\n    };\n\n    this.setCalculationHistoryEntries = function(historyEntries) {\n      document.getElementById('calculationhistory').innerHTML = historyEntries;\n    };\n\n    this.appendEntryToCalculationHistory = function(historyEntry) {\n      let calculationHistory = document.getElementById('calculationhistory');\n      calculationHistory.innerHTML += historyEntry;\n    };\n\n    // Functions for manipulating history persistent storage data.\n    //\n    this.createHistoryEntryInLocalStorage = function(formula, result) {\n      let historyEntry = {\n        formula: formula,\n        result: result,\n        timestamp: new Date().getTime()\n      };\n\n      localStorage.setItem(\n        `history${Calculator.nexthistoryindex}`,\n        JSON.stringify(historyEntry)\n      );\n      Calculator.nexthistoryindex++;\n    };\n\n    this.populateHistoryPaneFromLocalStorage = function() {\n      let firsthistoryindex = localStorage.getItem('firsthistoryindex');\n\n      if (firsthistoryindex === null) {\n        // Initialize history local storage if not used yet.\n        Calculator.nexthistoryindex = 0;\n        localStorage.setItem('firsthistoryindex', 0);\n      } else {\n        // If history local storage is used, then populate the history\n        // list with stored items that are less than a week old.\n        let time = new Date().getTime();\n        let historyEntries = '';\n\n        let i = firsthistoryindex;\n        let historyitemstr = localStorage.getItem(`history${i}`);\n        while (historyitemstr !== null) {\n          try {\n            let historyitem = JSON.parse(historyitemstr);\n\n            let oneWeek = 604800000; /* One week in milliseconds */\n            if (time - historyitem.timestamp > oneWeek) {\n              localStorage.removeItem(`history${i}`);\n              firsthistoryindex = i + 1;\n            } else {\n              historyEntries += Calculator.formHistoryEntry(\n                historyitem.formula,\n                historyitem.result\n              );\n            }\n          } catch (err) {\n            localStorage.removeItem(`history${i}`);\n          }\n\n          i++;\n          historyitemstr = localStorage.getItem(`history${i}`);\n        }\n        Calculator.setCalculationHistoryEntries(historyEntries);\n        localStorage.setItem('firsthistoryindex', firsthistoryindex);\n      }\n    };\n\n    // Functions for manipulating entries.\n    //\n    this.getMainEntry = function() {\n      return document.getElementById('mainentry').innerHTML;\n    };\n\n    this.setMainEntry = function(string) {\n      let mainentryelement = document.getElementById('mainentry');\n\n      mainentryelement.innerHTML = string;\n      document.getElementById('mpmainentry').innerHTML = string;\n\n      if (string === '') {\n        document.getElementById('buttonclear').innerHTML = 'AC';\n      } else {\n        document.getElementById('buttonclear').innerHTML = 'C';\n      }\n\n      Raf.queueClassChange(mainentryelement, 'mainentryshort');\n      if (mainentryelement.offsetWidth < mainentryelement.scrollWidth) {\n        Raf.queueClassChange(mainentryelement, 'mainentrylong');\n      }\n    };\n\n    this.appendToMainEntry = function(string) {\n      Calculator.setMainEntry(\n        document.getElementById('mainentry').innerHTML +\n        string\n      );\n    };\n\n    this.getCurrentFormula = function() {\n      return document.getElementById('currentformula').innerHTML;\n    };\n\n    this.setCurrentFormula = function(string) {\n      let currentformulaelement = document.getElementById('currentformula');\n\n      currentformulaelement.innerHTML = string;\n      Raf.queueClassChange(currentformulaelement, 'currentformulashort');\n      let thisOffsetWidth = currentformulaelement.offsetWidth;\n      let thisScrollWidth = currentformulaelement.scrollWidth;\n      if (thisOffsetWidth < thisScrollWidth) {\n        Raf.queueClassChange(currentformulaelement, 'currentformulalong');\n      }\n      Calculator.currentFormula = string;\n    };\n\n    this.appendToCurrentFormula = function(string) {\n      let newstring =\n        document.getElementById('currentformula').innerHTML +\n        string;\n      Calculator.currentFormula = newstring;\n      Calculator.setCurrentFormula(newstring);\n    };\n\n    // Functions for handling arrow button click events.\n    //\n    this.onButtonMainEntryToMemoryClick = function() {\n      let value = Calculator.getMainEntry();\n\n      Calculator.addValueToEmptyMemoryEntry(value);\n      Calculator.setFreeMemorySlot();\n    };\n\n    this.onButtonHistoryResultToMemoryClick = function(value) {\n      Calculator.addValueToEmptyMemoryEntry(value);\n    };\n\n    this.onButtonHistoryResultToMainEntryClick = function(value) {\n      Calculator.handleClearOnNumberButtonClick();\n\n      Calculator.setMainEntry(value);\n      Calculator.clearMainEntryOnNextNumberButton = true;\n      Calculator.clearMainEntryOnNextFunctionButton = false;\n    };\n\n    // Functions for manipulating memory entries.\n    //\n    this.addValueToEmptyMemoryEntry = function(value) {\n      if (value !== '') {\n        // Try to find an empty memory entry.\n        let i = Calculator.getNextEmptyMemorySlot();\n\n        if (i <= 8) {\n          // Empty memory entry found, store entry.\n          let mplusi = `M${i}`;\n          localStorage.setItem(mplusi, `${value}##`);\n          Calculator.setMemoryEntry(mplusi, value, '');\n          Raf.queueStyleChange(`#button${mplusi}`, 'color', '#d9e2d0');\n        }\n      }\n    };\n\n    this.getNextEmptyMemorySlot = function() {\n      let i = 1;\n      while (i <= 8) {\n        if (localStorage.getItem(`M${i}`) === null) {\n          break;\n        }\n\n        i++;\n      }\n      return i;\n    };\n\n    this.setMemoryEntry = function(key, value, description) {\n      let buttonkey = `#button${key}`;\n      let hashkey = `#${key}`;\n      let children = document.querySelector(buttonkey).children;\n      children[0].setAttribute('src', 'images/ico_arrow_white.png');\n      Raf.queueClassChange(`${buttonkey}edit`, 'buttonmemoryeditenabled');\n      Raf.queueClassChange(`${buttonkey}close`, 'buttonmemorycloseenabled');\n      document.querySelector(`${hashkey}text`).innerHTML = value;\n      document.querySelector(`${hashkey}description`).textContent =\n        description;\n      Raf.queueStyleChange(buttonkey, 'color', '#d9e2d0');\n    };\n\n    this.setMemoryDescription = function(key, description) {\n      let memoryitemstr = localStorage.getItem(key);\n\n      if (!(memoryitemstr === null)) {\n        let memoryitem = memoryitemstr.split('##');\n\n        Calculator.setMemoryEntry(key, memoryitem[0], description);\n        localStorage.setItem(key, `${memoryitem[0]}##${description}`);\n      }\n    };\n\n    this.onButtonMemoryEditClick = function(key) {\n      let keyElement = document.querySelector(`#button${key}edit`);\n      if (!keyElement.classList.contains('buttonmemoryeditenabled')) {\n        return;\n      }\n\n      Calculator.currentKey = key;\n      Raf.queueStyleChange('#memorynoteeditor', 'display', 'block');\n      let hashkey = `#${key}`;\n      let memoryitemstr = document.querySelector(`${hashkey}text`).textContent;\n      let description =\n        document.querySelector(`${hashkey}description`).textContent;\n      document.getElementById('mnebutton').textContent = key;\n      document.getElementById('mnetext').textContent = memoryitemstr;\n\n      let input = document.getElementById('mnedescriptioninput');\n      let text = document.getElementById('mnedescription');\n\n      if (\n        input.style.display === '' ||\n        input.style.display === 'none' ||\n        input.style.visibility !== 'visible'\n      ) {\n        input.style.display = 'inline';\n        text.style.display = '';\n        document.getElementById('mnedescriptioninput').focus();\n      } else {\n        input.style.display = '';\n        text.style.display = 'inline';\n      }\n\n      input.value = description;\n    };\n\n    this.onMemoryDescriptionInputFocusOut = function(key) {\n      let keydescription = `#${key}`;\n      let input = document.querySelector(`${keydescription}input`);\n      let value = input.value;\n      let description = document.querySelector(keydescription);\n\n      description.textContent = value;\n      Calculator.setMemoryDescription(key, value);\n      input.style.display = '';\n      Raf.queueStyleChange(description, 'display', 'inline');\n    };\n\n    this.onButtonMemoryClick = function(key) {\n      Calculator.handleClearOnNumberButtonClick();\n\n      let value = document.querySelector(`#${key}text`).textContent;\n\n      if (value !== null) {\n        Calculator.setMainEntry(value);\n        Calculator.clearMainEntryOnNextNumberButton = true;\n        Calculator.clearMainEntryOnNextFunctionButton = false;\n      }\n    };\n\n    this.onButtonMemoryCloseClick = function(key) {\n      let hashkey = `#${key}`;\n      let buttonkey = `#button${key}`;\n      let children = document.querySelector(buttonkey).children;\n      children[0].setAttribute('src', 'images/ico_arrow_black.png');\n      Raf.queueClassChange(`${buttonkey}edit`, 'buttonmemoryedit');\n      Raf.queueClassChange(`${buttonkey}close`, 'buttonmemoryclose');\n      Raf.queueClassChange(`${buttonkey}close`, 'buttonmemoryclose');\n      localStorage.removeItem(key);\n      document.querySelector(`${hashkey}descriptioninput`).value = '';\n      document.querySelector(`${hashkey}text`).textContent = '';\n      Raf.queueStyleChange(buttonkey, 'color', '#727272');\n      document.querySelector(`${hashkey}description`).textContent = '';\n    };\n\n    this.populateMemoryPaneFromLocalStorage = function() {\n      for (let i = 0; i < 9; i++) {\n        let memoryitemstr = localStorage.getItem(`M${i}`);\n\n        if (!(memoryitemstr === null)) {\n          let memoryitem = memoryitemstr.split('##');\n\n          Calculator.setMemoryEntry(`M${i}`, memoryitem[0], memoryitem[1]);\n        }\n      }\n    };\n\n    this.onButtonMemoryListClick = function() {\n      Raf.queueStyleChange('#memorypage', 'display', 'block');\n      Calculator.currentPage = 'memorypage';\n      document.getElementById('mpmainentry').innerHTML =\n        Calculator.getMainEntry();\n    };\n\n    this.onButtonMemoryClearAll = function() {\n      Raf.queueStyleChange('#clearconfirmationdialog', 'visibility', 'visible');\n    };\n\n    this.clearAllMemorySlots = function() {\n      Raf.queueStyleChange('#clearconfirmationdialog', 'visibility', 'hidden');\n      for (let i = 1; i <= 8; i++) {\n        Calculator.onButtonMemoryCloseClick(`M${i}`);\n      }\n      Calculator.setFreeMemorySlot();\n    };\n\n    this.cancelClearAllDialog = function() {\n      Raf.queueStyleChange('#clearconfirmationdialog', 'visibility', 'hidden');\n    };\n\n    this.onButtonMemoryClose = function() {\n      Calculator.setFreeMemorySlot();\n      Raf.queueStyleChange('#memorypage', 'display', '');\n      Calculator.currentPage = 'calculationpane';\n    };\n\n    // Function for initializing the UI buttons.\n    //\n    this.initButtons = function() {\n      let buttons = document.querySelectorAll(`\\\n.buttonblackshort,\\\n.buttonyellow,\\\n.buttonblack,\\\n.buttonblue:not(#buttondot)\\\n`\n      );\n      for (let i = 0; i < buttons.length; i++) {\n        let button = buttons[i];\n        button.addEventListener(\n          'mousedown',\n          Calculator.onFunctionButtonClick,\n          false\n        );\n      }\n\n      buttons = document.querySelectorAll('.buttonwhite');\n      for (let i = 0; i < buttons.length; i++) {\n        let thisButton = buttons[i];\n\n        thisButton.addEventListener(\n          'mousedown',\n          Calculator.onNumericalButtonClick,\n          false\n        );\n      }\n\n      // Initialize memorize button\n      Calculator.setFreeMemorySlot();\n\n      // Initialize button special cases.\n      let handlerMap = {\n        '#buttonclear': Calculator.onClearButtonClick,\n        '#buttondelete': Calculator.onDeleteButtonClick,\n        '#buttondot': Calculator.onNumericalButtonClick,\n        '#buttonplusminus': Calculator.onNumericalButtonClick,\n        '#buttonequal': Calculator.onEqualButtonClick\n      };\n      let keys = Object.keys(handlerMap);\n\n      for (let i = 0; i < keys.length; i++) {\n        let thisKey = keys[i];\n        let thisElement = document.querySelector(thisKey);\n        thisElement.addEventListener(\n          'mousedown',\n          handlerMap[thisKey],\n          false\n        );\n      }\n\n      Calculator.initAudio();\n    };\n\n    /**\n     * initializes the audio files and assigns audio for various button presses\n     */\n    this.initAudio = function() {\n      Calculator.buttonClickAudio = new Audio();\n      Calculator.buttonClickAudio.src = './audio/GeneralButtonPress_R2.ogg';\n      Calculator.equalClickAudio = new Audio();\n      Calculator.equalClickAudio.src = './audio/EqualitySign_R2.ogg';\n\n      let buttons = document.querySelectorAll(`\\\n#closehistorybutton,\\\n.historybutton,\\\n.buttonclose,\\\n.switchleftactive,\\\n.buttonpurple,\\\n.dialogAbuttonPurple,\\\n.dialogAbuttonBlack,\\\n.dialogBpurplebutton,\\\n.dialogBblackbutton,\\\n.buttonmemory,\\\n.buttonmemoryedit,\\\n.buttonmemoryclose\\\n`\n      );\n\n      let _addListener = function(button) {\n        button.addEventListener(\n          'mousedown',\n          () => Calculator.buttonClickAudio.play()\n        );\n      };\n\n      for (let i = 0; i < buttons.length; i++) {\n        let button = buttons[i];\n\n        _addListener(button);\n      }\n    };\n\n    this.openHistory = function() {\n      Raf.queueStyleChange('#LCD_Upper', 'display', 'block');\n      Raf.queueStyleChange('#licensebtnl', 'display', '');\n    };\n\n    this.closeHistory = function() {\n      Raf.queueStyleChange('#LCD_Upper', 'display', '');\n      Raf.queueStyleChange('#licensebtnl', 'display', 'block');\n      Raf.queueStyleChange(`#${Calculator.currentPage}`, 'display', 'block');\n      Calculator.historyScrollbar.refresh();\n      return false;\n    };\n\n    this.setFreeMemorySlot = function() {\n      let i = Calculator.getNextEmptyMemorySlot();\n      if (i <= 8) {\n        document.getElementById('buttonmemorizetext').innerHTML = `M${i}`;\n      } else {\n        document.getElementById('buttonmemorizetext').innerHTML = 'Mx';\n      }\n    };\n\n    this.registerInlineHandlers = function() {\n      let handlers = {\n        click: {\n          '#closehistorybutton': Calculator.closeHistory,\n          '#openhistorybutton': Calculator.openHistory,\n          '#buttondeg': Calculator.transitionToDegrees,\n          '#buttonrad': Calculator.transitionToRadians,\n          '#buttontrig': Calculator.transitionToTrigonometricFunctions,\n          '#buttonhyp': Calculator.transitionToHyperbolicFunctions,\n          '#buttonmemorylist': Calculator.onButtonMemoryListClick,\n          '#buttonmemorize': Calculator.onButtonMainEntryToMemoryClick,\n          '#memoryclearall': Calculator.onButtonMemoryClearAll,\n          '#memoryClose': Calculator.onButtonMemoryClose,\n          '#dialogokbutton': Calculator.clearAllMemorySlots,\n          '#dialogcancelbutton': Calculator.cancelClearAllDialog,\n          '#mpopenhistorybutton': Calculator.openHistory,\n\n          '#buttonclosecurrentformula': function() {\n            Calculator.setCurrentFormula('');\n          },\n          '#buttonclosemainentry, #mplcdbuttonclose': function() {\n            Calculator.setMainEntry('');\n          },\n          '#buttonM1': function() {\n            Calculator.onButtonMemoryClick('M1');\n          },\n          '#buttonM1edit': function() {\n            Calculator.onButtonMemoryEditClick('M1');\n          },\n          '#buttonM1close': function() {\n            Calculator.onButtonMemoryCloseClick('M1');\n          },\n          '#buttonM2': function() {\n            Calculator.onButtonMemoryClick('M2');\n          },\n          '#buttonM2edit': function() {\n            Calculator.onButtonMemoryEditClick('M2');\n          },\n          '#buttonM2close': function() {\n            Calculator.onButtonMemoryCloseClick('M2');\n          },\n          '#buttonM3': function() {\n            Calculator.onButtonMemoryClick('M3');\n          },\n          '#buttonM3edit': function() {\n            Calculator.onButtonMemoryEditClick('M3');\n          },\n          '#buttonM3close': function() {\n            Calculator.onButtonMemoryCloseClick('M3');\n          },\n          '#buttonM4': function() {\n            Calculator.onButtonMemoryClick('M4');\n          },\n          '#buttonM4edit': function() {\n            Calculator.onButtonMemoryEditClick('M4');\n          },\n          '#buttonM4close': function() {\n            Calculator.onButtonMemoryCloseClick('M4');\n          },\n          '#buttonM5': function() {\n            Calculator.onButtonMemoryClick('M5');\n          },\n          '#buttonM5edit': function() {\n            Calculator.onButtonMemoryEditClick('M5');\n          },\n          '#buttonM5close': function() {\n            Calculator.onButtonMemoryCloseClick('M5');\n          },\n          '#buttonM6': function() {\n            Calculator.onButtonMemoryClick('M6');\n          },\n          '#buttonM6edit': function() {\n            Calculator.onButtonMemoryEditClick('M6');\n          },\n          '#buttonM6close': function() {\n            Calculator.onButtonMemoryCloseClick('M6');\n          },\n          '#buttonM7': function() {\n            Calculator.onButtonMemoryClick('M7');\n          },\n          '#buttonM7edit': function() {\n            Calculator.onButtonMemoryEditClick('M7');\n          },\n          '#buttonM7close': function() {\n            Calculator.onButtonMemoryCloseClick('M7');\n          },\n          '#buttonM8': function() {\n            Calculator.onButtonMemoryClick('M8');\n          },\n          '#buttonM8edit': function() {\n            Calculator.onButtonMemoryEditClick('M8');\n          },\n          '#buttonM8close': function() {\n            Calculator.onButtonMemoryCloseClick('M8');\n          }\n        },\n        focusout: {\n          '#M1descriptioninput': function() {\n            Calculator.onMemoryDescriptionInputFocusOut('M1');\n          },\n          '#M2descriptioninput': function() {\n            Calculator.onMemoryDescriptionInputFocusOut('M2');\n          },\n          '#M3descriptioninput': function() {\n            Calculator.onMemoryDescriptionInputFocusOut('M3');\n          },\n          '#M4descriptioninput': function() {\n            Calculator.onMemoryDescriptionInputFocusOut('M4');\n          },\n          '#M5descriptioninput': function() {\n            Calculator.onMemoryDescriptionInputFocusOut('M5');\n          },\n          '#M6descriptioninput': function() {\n            Calculator.saveMemoryDescription('M6');\n          },\n          '#M7descriptioninput': function() {\n            Calculator.onMemoryDescriptionInputFocusOut('M7');\n          },\n          '#M8descriptioninput': function() {\n            Calculator.saveMemoryDescription('M8');\n          }\n        }\n      };\n\n      let events = Object.keys(handlers);\n      events.forEach(function(event) {\n        let selectors = Object.keys(handlers[event]);\n\n        selectors.forEach(function(selector) {\n          let handler = handlers[event][selector];\n          let elements = document.querySelectorAll(selector);\n\n          for (let i = 0; i < elements.length; i++) {\n            let element = elements[i];\n            element.addEventListener(event, handler);\n          }\n        });\n      });\n    };\n\n    this.registerMneClickHandlers = function() {\n      document.getElementById('mnecancel').addEventListener(\n        'click',\n        function() {\n          Raf.queueStyleChange('#memorynoteeditor', 'display', 'none');\n        }\n      );\n\n      document.getElementById('mnesave').addEventListener(\n        'click',\n        function() {\n          Raf.queueStyleChange('#memorynoteeditor', 'display', '');\n          let mnedescriptioninputval =\n            document.getElementById('mnedescriptioninput').value;\n          document.getElementById(\n            `${Calculator.currentKey}description`\n          ).textContent = mnedescriptioninputval;\n          Calculator.setMemoryDescription(\n            Calculator.currentKey,\n            mnedescriptioninputval\n          );\n        }\n      );\n\n      document.getElementById('mnedescriptiondelete')\n        .addEventListener('click', function() {\n          document.getElementById('mnedescriptioninput').value = '';\n        });\n    };\n\n    /**\n     * register for the orientation event changes\n     * changing layout is handled by @media, but resize is done manually\n     */\n    this.registerOrientationChange = function() {\n      // on page create\n      document.addEventListener('pagecreate', function() {\n        Raf.maximiseBody();\n      });\n\n      document.addEventListener('create', function() {\n        Raf.maximiseBody();\n      });\n\n      if ('onorientationchange' in window) {\n        window.onorientationchange = function() {\n          Raf.maximiseBody();\n        };\n\n        window.onresize = function() {\n          Raf.maximiseBody();\n        };\n      } else {\n        window.onresize = function() {\n          if (window.innerHeight > window.innerWidth) {\n            window.orientation = 0;\n          } else {\n            window.orientation = 90;\n          }\n\n          Raf.maximiseBody();\n        };\n      }\n    };\n\n    /**\n     * creates scroll bar for the history page\n     */\n    this.createScrollbars = function() {\n      Calculator.historyScrollbar = new IScroll('#wrapper',\n        {\n          scrollbarClass: 'customScrollbar',\n          hScrollbar: true, vScrollbar: true,\n          hideScrollbar: true,\n          checkDOMChanges: true\n        });\n    };\n\n    this.fillServiceWorkerCache = function() {\n      let allFiles = [\n        \"/css/calc.css\",\n        \"/css/lazy.css\",\n        \"/css/calc_portrait.css\",\n        \"/css/lazy_portrait.css\",\n        \"/css/jquery.jscrollpane.css\",\n        \"/sw-import.js\",\n        \"/manifest.json\",\n        \"/locales/fi/messages.json\",\n        \"/locales/en_US/messages.json\",\n        \"/locales/locales.json\",\n        \"/audio/GeneralButtonPress_R2.ogg\",\n        \"/audio/EqualitySign_R2.ogg\",\n        \"/index.html\",\n        \"/js/localizer.js\",\n        \"/js/license.js\",\n        \"/js/help.js\",\n        \"/js/calc.js\",\n        \"/data/peg-code.txt\",\n        \"/lib/open-sans/index.woff\",\n        \"/lib/polymer/polymer-micro.html\",\n        \"/lib/polymer/polymer.html\",\n        \"/lib/polymer/polymer-mini.html\",\n        \"/lib/fetch/fetch.js\",\n        \"/lib/webcomponentsjs/MutationObserver.js\",\n        \"/lib/webcomponentsjs/ShadowDOM.js\",\n        \"/lib/webcomponentsjs/HTMLImports.js\",\n        \"/lib/webcomponentsjs/webcomponents-lite.min.js\",\n        \"/lib/webcomponentsjs/webcomponents.min.js\",\n        \"/lib/webcomponentsjs/MutationObserver.min.js\",\n        \"/lib/webcomponentsjs/ShadowDOM.min.js\",\n        \"/lib/webcomponentsjs/CustomElements.min.js\",\n        \"/lib/webcomponentsjs/HTMLImports.min.js\",\n        \"/lib/webcomponentsjs/CustomElements.js\",\n        \"/lib/webcomponentsjs/webcomponents.js\",\n        \"/lib/webcomponentsjs/webcomponents-lite.js\",\n        \"/lib/sw-toolbox/sw-toolbox.map.json\",\n        \"/lib/sw-toolbox/recipes/common.css\",\n        \"/lib/sw-toolbox/recipes/cache-expiration-options/service-worker.js\",\n        \"/lib/sw-toolbox/recipes/cache-expiration-options/styles.css\",\n        \"/lib/sw-toolbox/recipes/cache-expiration-options/app.js\",\n        \"/lib/sw-toolbox/recipes/cache-expiration-options/index.html\",\n        \"/lib/sw-toolbox/recipes/index.html\",\n        \"/lib/sw-toolbox/companion.js\",\n        \"/lib/sw-toolbox/sw-toolbox.js\",\n        \"/lib/open-sans-light/index.woff\",\n        \"/lib/platinum-sw/service-worker.js\",\n        \"/lib/platinum-sw/bootstrap/sw-toolbox-setup.js\",\n        \"/lib/platinum-sw/bootstrap/offline-analytics.js\",\n        \"/lib/platinum-sw/bootstrap/simple-db.js\",\n        \"/lib/platinum-sw/platinum-sw-fetch.html\",\n        \"/lib/platinum-sw/platinum-sw-import-script.html\",\n        \"/lib/platinum-sw/platinum-sw-elements.html\",\n        \"/lib/platinum-sw/platinum-sw-register.html\",\n        \"/lib/platinum-sw/platinum-sw-cache.html\",\n        \"/lib/platinum-sw/index.html\",\n        \"/lib/platinum-sw/platinum-sw-offline-analytics.html\",\n        \"/lib/iscroll/dist/iscroll-zoom-min.js\",\n        \"/lib/iscroll/dist/iscroll-min.js\",\n        \"/lib/iscroll/dist/iscroll-lite-min.js\",\n        \"/lib/iscroll/dist/iscroll-probe-min.js\",\n        \"/lib/es6-promise/es6-promise.js\",\n        \"/lib/es6-promise/promise.js\",\n        \"/lib/es6-promise/es6-promise.min.js\",\n        \"/lib/es6-promise/promise.min.js\",\n        \"/lib/open-sans-semibold/index.woff\",\n        \"/lib/pegjs/peg-0.9.0.js\",\n        \"/lib/pegjs/peg-0.9.0.min.js\",\n        \"/images/switch_science_land_press.png\",\n        \"/images/bt_yellow_port.png\",\n        \"/images/switch_science_port_press.png\",\n        \"/images/bg_memory_list_port.png\",\n        \"/images/scrollbar_bottom.png\",\n        \"/images/line_history_hor2px_land.png\",\n        \"/images/switch_single_land.png\",\n        \"/images/icon_300.png\",\n        \"/images/bt_blue_land_press.png\",\n        \"/images/bt_equals_port_press.png\",\n        \"/images/bt_dialogB_purple.png\",\n        \"/images/bt_white_port_press.png\",\n        \"/images/LineHorizontalBlackThick.png\",\n        \"/images/bt_black_port_press.png\",\n        \"/images/bg_display_memory_land.png\",\n        \"/images/bt_dialogB_purple_press.png\",\n        \"/images/bt_dialogA_purple.png\",\n        \"/images/bg_keyboard_port.png\",\n        \"/images/bt_history_exp_land_press.png\",\n        \"/images/bt_whiteA_land.png\",\n        \"/images/bg_display_land.png\",\n        \"/images/bt_blue_land.png\",\n        \"/images/bt_dialogA_purple_press.png\",\n        \"/images/bt_white_port.png\",\n        \"/images/switch_single_port_press.png\",\n        \"/images/bt_purple_land.png\",\n        \"/images/bt_blackSmall_land_press.png\",\n        \"/images/bt_blue_port.png\",\n        \"/images/bt_whiteA_port_press.png\",\n        \"/images/bg_land.png\",\n        \"/images/bt_purple_port.png\",\n        \"/images/bt_white_land_press.png\",\n        \"/images/ico_arrow_black.png\",\n        \"/images/switch_land_left_act.png\",\n        \"/images/bt_red_land_press.png\",\n        \"/images/bt_yellow_port_press.png\",\n        \"/images/bg_memory_slot_land.png\",\n        \"/images/bt_yellow_land.png\",\n        \"/images/switch_science_port.png\",\n        \"/images/bt_blackSmall_port_press.png\",\n        \"/images/bt_history_contr_port_press.png\",\n        \"/images/LineVertical19Black.png\",\n        \"/images/bt_whiteA_land_press.png\",\n        \"/images/ico_mem_list.png\",\n        \"/images/clear_memory.png\",\n        \"/images/bt_equals_port.png\",\n        \"/images/switch_science_land.png\",\n        \"/images/bt_grey_port.png\",\n        \"/images/bt_history_exp_land.png\",\n        \"/images/pencil_disable.png\",\n        \"/images/bg_history_land.png\",\n        \"/images/bt_red_port.png\",\n        \"/images/bg_port.png\",\n        \"/images/bt_whiteB_port.png\",\n        \"/images/bt_whiteB_land.png\",\n        \"/images/bt_history_contr_port.png\",\n        \"/images/switch_single_land_act.png\",\n        \"/images/line_history_hor4px_port.png\",\n        \"/images/line_display_land.png\",\n        \"/images/bt_purple_land_press.png\",\n        \"/images/ico_back.png\",\n        \"/images/bt_yellow_land_press.png\",\n        \"/images/clear_memory_press.png\",\n        \"/images/line_history_hor4px_land.png\",\n        \"/images/LineHorizontalBlack.png\",\n        \"/images/bg_memory_note.png\",\n        \"/images/bt_whiteB_land_press.png\",\n        \"/images/bt_purple_port_press.png\",\n        \"/images/bt_red_land.png\",\n        \"/images/switch_single_land_press.png\",\n        \"/images/ico_arrow_grey.png\",\n        \"/images/switch_port_right_act.png\",\n        \"/images/bt_grey_land.png\",\n        \"/images/bt_bin_press.png\",\n        \"/images/LineVertical38Black.png\",\n        \"/images/pencil_press.png\",\n        \"/images/switch_science_land_act.png\",\n        \"/images/bt_whiteB_port_press.png\",\n        \"/images/bt_history_contr_land.png\",\n        \"/images/bt_dialogA_black_press.png\",\n        \"/images/bg_keyboard_land.png\",\n        \"/images/bt_black_land.png\",\n        \"/images/bt_history_exp_port.png\",\n        \"/images/bt_whiteA_port.png\",\n        \"/images/clear_memory_disable.png\",\n        \"/images/bg_history_port.png\",\n        \"/images/clear_text_press.png\",\n        \"/images/bt_history_exp_port_press.png\",\n        \"/images/bt_dialogB_blacks.png\",\n        \"/images/bt_red_port_press.png\",\n        \"/images/switch_single_port.png\",\n        \"/images/bg_memory_list_land.png\",\n        \"/images/bt_equals_land.png\",\n        \"/images/switch_port_press.png\",\n        \"/images/bg_display_port.png\",\n        \"/images/bg_dialog.png\",\n        \"/images/ico_arrow_white.png\",\n        \"/images/switch_land_right_act.png\",\n        \"/images/bt_equals_land_press.png\",\n        \"/images/clear_text.png\",\n        \"/images/bt_blue_port_press.png\",\n        \"/images/bg_display_memory_port.png\",\n        \"/images/bt_blackSmall_port.png\",\n        \"/images/bt_black_port.png\",\n        \"/images/switch_science_port_act.png\",\n        \"/images/switch_single_port_act.png\",\n        \"/images/bt_mem_list_land.png\",\n        \"/images/line_history_vert_land.png\",\n        \"/images/bt_blackSmall_land.png\",\n        \"/images/bt_dialogB_black_press.png\",\n        \"/images/bt_bin.png\",\n        \"/images/bt_dialogA_black.png\",\n        \"/images/line_history_hor2px_port.png\",\n        \"/images/bt_mem_list_land_press.png\",\n        \"/images/line_display_port.png\",\n        \"/images/switch_land_press.png\",\n        \"/images/switch_port_left_act.png\",\n        \"/images/line_keyboard_land.png\",\n        \"/images/line_keyboard_port.png\",\n        \"/images/line_history_vert_port.png\",\n        \"/images/scrollbar_top.png\",\n        \"/images/bg_memory_slot_port.png\",\n        \"/images/scrollbar_middle.png\",\n        \"/images/bt_black_land_press.png\",\n        \"/images/pencil.png\",\n        \"/images/bt_white_land.png\",\n        \"/images/bt_history_contr_land_press.png\",\n        \"/lazy.html\"\n      ];\n\n      document.addEventListener('WebComponentsReady', function() {\n        document.querySelector('platinum-sw-cache').precache = allFiles;\n      });\n    };\n  };\n\n  (function() {\n    let link = document.createElement('link');\n    link.setAttribute('rel', 'stylesheet');\n    link.setAttribute('media', 'all and (orientation:landscape)');\n    link.setAttribute('href', 'css/lazy.css');\n\n    Raf.queueAppendChild(document.head, link);\n\n    link = document.createElement('link');\n    link.setAttribute('rel', 'stylesheet');\n    link.setAttribute('media', 'all and (orientation:portrait)');\n    link.setAttribute('href', 'css/lazy_portrait.css');\n\n    Raf.queueAppendChild(document.head, link);\n\n    Calculator.registerOrientationChange();\n\n    fetch('lazy.html').then(function(response) {\n      return response.text();\n    }).then(function(body) {\n      // inject rest of js files\n      // and run Calculator init code that depends on them\n\n      let lazyScripts = [\n        {\n          type: 'script',\n          file: 'lib/webcomponentsjs/webcomponents-lite.min.js',\n          success: function(resolve) {\n            // once webcomponents is loaded, load the polymer elements\n            let files = [\n              'lib/platinum-sw/platinum-sw-register.html',\n              'lib/platinum-sw/platinum-sw-cache.html'\n            ];\n            let elements = [];\n\n            files.forEach(function(file) {\n              let element = document.createElement('link');\n              element.setAttribute('rel', 'import');\n              element.setAttribute('href', file);\n              elements.push(element);\n            });\n\n            elements.forEach(function(element) {\n              Raf.queueAppendChild(document.head, element);\n            });\n\n            Calculator.fillServiceWorkerCache();\n\n            resolve();\n          }\n        },\n        {\n          type: 'script',\n          file: 'lib/pegjs/peg-0.9.0.min.js',\n          success: function(resolve) {\n            fetch('data/peg-code.txt').then(function(response) {\n              return response.text();\n            }).then(function(data) {\n              try {\n                Calculator.parser = PEG.buildParser(data);\n                resolve();\n              } catch (err) {\n                console.log(err.message);\n              }\n            });\n          }\n        },\n        {\n          type: 'script',\n          file: 'js/license.js',\n          success: function(resolve) {\n            licenseInit('license', 'background');\n            document.getElementById('licensebtnl')\n              .addEventListener('mousedown', function() {\n                Calculator.buttonClickAudio.play();\n              });\n            document.getElementById('licensebtnq')\n              .addEventListener('mousedown', function() {\n                Calculator.buttonClickAudio.play();\n              });\n            resolve();\n          }\n        },\n        {\n          type: 'script',\n          file: 'js/help.js',\n          success: function(resolve) {\n            helpInit('home_help', 'help_');\n            document.getElementById('home_help')\n              .addEventListener('mousedown', function() {\n                Calculator.buttonClickAudio.play();\n              });\n            document.getElementById('help_close')\n              .addEventListener('mousedown', function() {\n                Calculator.buttonClickAudio.play();\n              });\n            resolve();\n          }\n        },\n        {\n          type: 'script',\n          file: 'js/localizer.js',\n          success: function(resolve) {\n            Calculator.localizer = new Localizer();\n            Calculator.localizer.localizeHtmlElements();\n            resolve();\n          }\n        },\n        {\n          type: 'script',\n          file: 'lib/iscroll/dist/iscroll-lite-min.js',\n          success: function(resolve) {\n            Calculator.createScrollbars();\n            resolve();\n          }\n        }\n      ];\n      let promises = [];\n\n      // complete body\n      document.body.innerHTML += body;\n\n      Calculator.registerMneClickHandlers();\n\n      let makeSuccessScript = function(success, resolve) {\n        return function() {\n          success(resolve);\n        };\n      };\n\n      let makePromise = function(i) {\n        return new Promise(function(resolve) {\n          let element;\n          if (lazyScripts[i].type === 'script') {\n            element = document.createElement('script');\n            element.onload = makeSuccessScript(\n              lazyScripts[i].success,\n              resolve\n            );\n            element.setAttribute('src', lazyScripts[i].file);\n          }\n\n          Raf.queueAppendChild(document.head, element);\n        });\n      };\n\n      // inject js and html import elements\n      for (let i = 0; i < lazyScripts.length; i++) {\n        promises.push(makePromise(i));\n      }\n\n      // once all js files have been loaded and initialised/etc, do the rest\n      Promise.all(promises).then(function() {\n        Calculator.initButtons();\n        Calculator.setMainEntry('');\n        Calculator.setCurrentFormula('');\n        Calculator.transitionToDegrees();\n        Calculator.transitionToTrigonometricFunctions();\n        Calculator.equalPressed = false;\n        Calculator.populateMemoryPaneFromLocalStorage();\n        Calculator.populateHistoryPaneFromLocalStorage();\n        Calculator.registerInlineHandlers();\n        let buttons = document.querySelectorAll('button');\n        for (let i = 0; i < buttons.length; i++) {\n          buttons[i].disabled = false;\n        }\n\n        Raf.maximiseBody();\n\n        console.timeStamp('MAXMAXMAX:Buttons Enabled');\n      }, function() {\n        console.error('something wrong with promises');\n      });\n    });\n  })();\n})();\n"]}